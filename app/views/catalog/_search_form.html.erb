<div id="search-bar">
<div id="search" class="search">
  <%= form_tag catalog_index_path, :method => :get do %>
    <h2 class="search"><%= label_tag(:q, "Search Archive") %></h2>
    <div class="q_field">
      <%= text_field_tag :q, params[:q], :class => "q", :placeholder => "Search Archive" %>
    
    <%= hidden_field_tag :search_field, 'all_fields' %>
    <%= search_as_hidden_fields(:omit_keys => [:q, :search_field, :qt, :page, :id]) %>        
    
    <%= image_submit_tag("magnifying-glass.gif", :alt => "Submit", :class => 'submit') %>
  </div>
  <% if  @controller.controller_name == 'catalog' and  @controller.action_name == 'index' %>
  <div class="search_context">
  <%= radio_button_tag 'search_context', 'all', @search_context == 'all' || @search_context.nil? %><%= label_tag 'new_search_true', 'All Records' %>
  <%= radio_button_tag 'search_context', 'result', @search_context == 'result' %><%= label_tag 'new_search_false', 'Within Results' %>
  </div>
<% end %>
  <% end %>

  <hr/>
</div>

<div id="browse">
  <h2 class="search">Browse Archive</h2>
  <%# cache(:controller => 'catalog', :action => 'browse', :action_suffix => "categories") do %>
    <%= form_tag catalog_index_path, :method => :get, :class => 'categories' do %>
      <%= select 'f', 'merlot_s', grouped_options_for_select({"Categories" => top_level_categories.items.map { |x| x.value.gsub('1/', '') } }), { :prompt => "Categories" }, :name => 'f[merlot_s][]' %>
      <%= submit_tag %>
    <% end %>
  <%# end %>

  <%# cache(:controller => 'catalog', :action => 'browse', :action_suffix => "categories") do %>
    <%= form_tag catalog_index_path, :method => :get, :class => 'collections' do %>
      <%= select "id", nil, grouped_options_for_select(collections_list.group_by { |x| x.get("dc_type_s") }.map { |key, values| [key.pluralize, values.map { |x| [x.get('title_display'), x.get('id')] }]}.sort_by { |x| x.first }), { :prompt => "Series and Collections" }  %>
      <%= submit_tag %>
    <% end %>
  <%# end %>
</div>
</div>
